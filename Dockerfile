FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wLjAKbmFtZTogaGFzdGViaW4tYXBiCmRlc2NyaXB0aW9uOiBUaGlzIGlzIGEg\
c2FtcGxlIGFwcGxpY2F0aW9uIGdlbmVyYXRlZCBieSBhcGIgaW5pdApiaW5kYWJsZTogRmFsc2UK\
YXN5bmM6IG9wdGlvbmFsCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiBIYXN0ZWJpbiAoQVBCKQog\
IGRlcGVuZGVuY2llczogWydkb2NrZXIuaW8vZHltdXJyYXkvaGFzdGViaW46bGF0ZXN0JywgJ2Rv\
Y2tlci5pby9tb2R1bGFyaXR5Y29udGFpbmVycy9tZW1jYWNoZWQ6bGF0ZXN0J10KICBwcm92aWRl\
ckRpc3BsYXlOYW1lOiAiUmVkIEhhdCwgSW5jLiIKcGxhbnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAg\
ICBkZXNjcmlwdGlvbjogVGhpcyBkZWZhdWx0IHBsYW4gZGVwbG95cyBoYXN0ZWJpbi1hcGIKICAg\
IGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOiB7fQogICAgcGFyYW1ldGVyczoKICAgICAgLSBuYW1l\
OiBoYXN0ZWJpbl9wb3J0CiAgICAgICAgdHlwZTogaW50CiAgICAgICAgZGVmYXVsdDogNzc3Nwog\
ICAgICAgIHRpdGxlOiBIYXN0ZWJpbiBQb3J0CiAgICAgIC0gbmFtZTogbWF4X2xlbmd0aAogICAg\
ICAgIHR5cGU6IGludAogICAgICAgIGRlZmF1bHQ6IDQwMDAwMAogICAgICAgIHRpdGxlOiBNYXgg\
bGVuZ3RoIG9mIGhhc3RlYmluIGVudHJ5CiAgICAgIC0gbmFtZToga2V5X2xlbmd0aAogICAgICAg\
IHR5cGU6IGludAogICAgICAgIGRlZmF1bHQ6IDEwCiAgICAgICAgdGl0bGU6IExlbmd0aCBvZiBo\
YXN0ZWJpbiBrZXkK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
